<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‘ì—…ë³„ ë³´í˜¸êµ¬ ì°©ìš© ì˜·ì…íˆê¸° ê²Œì„</title>
  <style>
    /* === ê¸°ë³¸ ì„¸íŒ… === */
    *{box-sizing:border-box}
    body{margin:0;padding:0;font-family:sans-serif}

    /* í˜ì´ì§€ ê¸°ë³¸Â·í™œì„± */
    .page{display:none;width:100%;padding:20px}
    .page.active{display:block}
    .flex-page.active{display:flex;justify-content:center;align-items:center;min-height:100vh}

    /* ê³µí†µ */
    .center{text-align:center}
    .card{
      background:#fff;border-radius:20px;
      box-shadow:0 15px 25px rgba(0,0,0,.1);
      padding:40px;width:100%;max-width:600px;margin:0 auto
    }
    .button{
      padding:12px 24px;margin:10px;font-size:16px;cursor:pointer;
      color:#fff;border:none;border-radius:8px;
      background:linear-gradient(135deg,#007bff 0%,#0063ff 100%);
      box-shadow:0 4px 12px rgba(0,0,0,.15);transition:transform .1s
    }
    .button:hover{transform:translateY(-2px)}
    .restart-button{
      background:linear-gradient(135deg,#6a63ff 0%,#4e45d5 100%);
      color:#fff;border:none;padding:10px 20px;margin:10px;font-size:16px;
      cursor:pointer;border-radius:8px;transition:transform .1s
    }
    .restart-button:hover{transform:translateY(-2px)}
    .rounded-border{border:1px solid #000;border-radius:10px}

    /* ë°°ê²½ */
    #page1{background:linear-gradient(135deg,#7b5dff 0%,#4a8dff 100%)}
    #page2{background:radial-gradient(circle at top left,#f3f3f5 0%,#e9e9eb 100%)}
    #page8{background:linear-gradient(135deg,#b6f0e8 0%,#d3ecf6 50%,#ffd6e6 100%)}

    /* í˜ì´ì§€1 */
    #page1 .card{display:flex;flex-direction:column;align-items:center}
    #page1 h1{white-space:nowrap;margin:0 0 24px 0}
    #page1 img{max-width:100%;height:auto}

    /* í˜ì´ì§€2 */
    .blink{color:red}
    #page2 .card input{
      width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;font-size:16px
    }

    /* í˜ì´ì§€3~7 */
    .worker-container{position:relative;width:100%;text-align:center}
    .worker-image{width:100%;height:auto;display:block;margin:0 auto}
    .gear-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:20px}
    .gear-item img{width:80%;display:block;cursor:pointer;margin:0 auto}

    /* ì ìˆ˜Â·ê¸°íšŒ í‘œì‹œ */
    .score-display,.chances-display{
      position:fixed;right:10px;z-index:1000;min-width:100px;
      padding:10px;border-radius:5px;font-weight:bold;text-align:center}
    .score-display{bottom:60px;background:#f0f0f0;border:1px solid #ccc}
    .chances-display{bottom:10px}
    .cycle-1{background:#e8f5e8!important;border:2px solid #4caf50!important;color:#2e7d32!important}
    .cycle-2{background:#fff3e0!important;border:2px solid #ff9800!important;color:#e65100!important}
    .cycle-3-plus{background:#ffebee!important;border:2px solid #f44336!important;color:#d32f2f!important}

    /* í˜ì´ì§€8 */
    #certificate-box{
      border:2px solid #000;padding:20px;border-radius:12px;text-align:center
    }
    .ranking-table{margin:30px auto 0;border-collapse:collapse;width:100%;max-width:600px}
    .ranking-table th,.ranking-table td{border:1px solid #ddd;padding:8px;text-align:center}
    .ranking-table th{background:#f2f2f2;font-weight:700}
    .ranking-table tr:nth-child(even){background:#f9f9f9}
    .loading{text-align:center;color:#666;font-style:italic}
  </style>
</head>
<body>
  <!-- ì ìˆ˜ / ê¸°íšŒ -->
  <div id="score-display" class="score-display" style="display:none">ì ìˆ˜: <span id="current-score">0</span></div>
  <div id="chances-display" class="chances-display" style="display:none">í´ë¦­ ê¸°íšŒ: <span id="remaining-chances">âˆ</span></div>

  <!-- í˜ì´ì§€ 1 -->
  <div id="page1" class="page flex-page active">
    <div class="card">
      <h1>ì‘ì—…ë³„ ë³´í˜¸êµ¬ ì°©ìš© êµìœ¡</h1>
      <img src="https://i.imgur.com/Tu6mJ5J.png" alt="ë©”ì¸ ì´ë¯¸ì§€">
      <button class="button" id="startButton">êµìœ¡ ì‹œì‘í•˜ê¸°</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 2 -->
  <div id="page2" class="page flex-page">
    <div class="card">
      <h2 class="center">êµìœ¡ ì •ë³´ ì…ë ¥</h2>
      <label>í˜„ì¥ëª…:</label><br>
      <input id="siteName" placeholder="í˜„ì¥ëª… ì…ë ¥"><br><br>
      <label>ê·¼ë¡œì ì´ë¦„:</label><br>
      <input id="workerName" placeholder="ì´ë¦„ ì…ë ¥"><br><br>
      <label>ì†Œì†:</label><br>
      <input id="workerAffiliation" placeholder="ì†Œì† ì…ë ¥"><br><br>
      <div class="blink" style="padding:16px;border:1px solid #ffb6b6;background:#ffecec;border-radius:6px">
        ì‘ì—… ìƒí™©ì— ë”°ë¥¸ ë³´í˜¸êµ¬ ì°©ìš© ê¸°ì¤€ì„ ì˜·ì…íˆê¸° ê²Œì„ ë°©ì‹ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤.<br>
        ê·¼ë¡œì ìºë¦­í„° í•˜ë‹¨ì˜ ë³´í˜¸êµ¬ë¥¼ í´ë¦­í•˜ì—¬ ì˜¬ë°”ë¥¸ ë³´í˜¸êµ¬ë¥¼ ì°©ìš©ì‹œì¼œì£¼ì„¸ìš”.
      </div><br>
      <button class="button" id="toPage3" style="width:100%">ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 3 -->
  <div id="page3" class="page">
    <h2>ê³ ì†Œì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/Ifwwzoz.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-3"></div>
    <div id="error-message-3" style="color:red;text-align:center;margin-top:10px"></div>
    <div class="center button-group" id="button-container-3">
      <button class="button" id="next-button-3" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 4 -->
  <div id="page4" class="page">
    <h2>ìš©ì ‘ì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/WlQOZoc.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-4"></div>
    <div id="error-message-4" style="color:red;text-align:center;margin-top:10px"></div>
    <div class="center button-group" id="button-container-4">
      <button class="button" id="next-button-4" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 5 -->
  <div id="page5" class="page">
    <h2>ì •ì „ì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/WlQOZoc.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-5"></div>
    <div id="error-message-5" style="color:red;text-align:center;margin-top:10px"></div>
    <div class="center button-group" id="button-container-5">
      <button class="button" id="next-button-5" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 6 -->
  <div id="page6" class="page">
    <h2>ë„ì¥ì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/Ifwwzoz.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-6"></div>
    <div id="error-message-6" style="color:red;text-align:center;margin-top:10px"></div>
    <div class="center button-group" id="button-container-6">
      <button class="button" id="next-button-6" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 7 -->
  <div id="page7" class="page">
    <h2>ì¼ë°˜ì‘ì—… ê³µí†µì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/Ifwwzoz.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-7"></div>
    <div id="error-message-7" style="color:red;text-align:center;margin-top:10px"></div>
    <div class="center button-group" id="button-container-7">
      <button class="button" id="next-button-7" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€ 8 -->
  <div id="page8" class="page flex-page">
    <div class="card center">
      <div id="certificate-box">
        <h2 style="margin-top:0">ìˆ˜ë£Œì¦</h2>
        <p id="cert-siteName"></p>
        <p id="cert-workerName"></p>
        <p id="cert-workerAffiliation"></p>
        <p>ë³´í˜¸êµ¬ êµìœ¡ì„ ëª¨ë‘ ìˆ˜ë£Œí•˜ì…¨ìŠµë‹ˆë‹¤.</p>
      </div>

      <!-- ì ìˆ˜ëŠ” PNGì— í¬í•¨ë˜ì§€ ì•Šë„ë¡ ë°•ìŠ¤ ë°– -->
      <p id="final-score-display" style="margin-top:20px">ìµœì¢… ì ìˆ˜: <span id="final-score">0</span>ì </p>

      <button class="button" id="saveCert">ì €ì¥í•˜ê¸°</button>
      <button class="button" id="homeButton">í™ˆìœ¼ë¡œ</button>

      <h3>ğŸ† ì´ë²ˆ ì£¼ ë­í‚¹</h3>
      <div id="ranking-loading" class="loading">ë­í‚¹ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
      <table id="ranking-table" class="ranking-table" style="display:none">
        <thead>
          <tr><th>ìˆœìœ„</th><th>ê·¼ë¡œì ì´ë¦„</th><th>í˜„ì¥ëª…</th><th>ì†Œì†</th><th>ì ìˆ˜</th></tr>
        </thead>
        <tbody id="ranking-body"></tbody>
      </table>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- ===== JavaScript : ì „ì²´ ê²Œì„ ë¡œì§ (ëˆ„ë½ ì—†ì´ í¬í•¨) ===== -->
  <script>
    /* ------------------------------------------------------------------
       ê¸°ì¡´ JS ë¡œì§ ì „ì²´
    ------------------------------------------------------------------ */

    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyDqZFIp_jzaUFiNlZxO3AYI3b8H9zDgyW4",
      authDomain: "training-private-equipment.firebaseapp.com",
      projectId: "training-private-equipment",
      storageBucket: "training-private-equipment.firebasestorage.app",
      messagingSenderId: "428074253490",
      appId: "1:428074253490:web:77d4040f8af17338795dab"
    };

    let db = null;
    try {
      firebase.initializeApp(firebaseConfig);
      db = firebase.firestore();
    } catch (e) {
      console.log("Firebase ì‚¬ìš© ë¶ˆê°€, ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¡œ ì „í™˜");
    }

    /* ---------- ë³´í˜¸êµ¬ ë°ì´í„° ---------- */
    const pageGearData = {/* (ìƒëµ ì—†ìŒ: ì›ë³¸ ë°°ì—´ ê·¸ëŒ€ë¡œ) */};
    pageGearData[3]=[{id:1,thumbnail:"https://i.imgur.com/yvsCOBF.png",overlay:"https://i.imgur.com/yTJe79p.png",correct:true,applied:false,zIndex:1},{id:2,thumbnail:"https://i.imgur.com/8gsL65v.png",overlay:"https://i.imgur.com/zBCjthf.png",correct:true,applied:false,zIndex:2},{id:3,thumbnail:"https://i.imgur.com/nvoxlp7.png",overlay:"https://i.imgur.com/VfJMtc3.png",correct:true,applied:false,zIndex:3},{id:4,thumbnail:"https://i.imgur.com/m1GZRHc.png",overlay:"https://i.imgur.com/Cphm4b5.png",correct:true,applied:false,zIndex:4},{id:5,thumbnail:"https://i.imgur.com/d7Plzcn.png",overlay:"https://i.imgur.com/5VxjKY6.png",correct:true,applied:false,zIndex:5},{id:6,thumbnail:"https://i.imgur.com/Ui2tbVv.png",overlay:"",correct:false,applied:false,zIndex:6}];
    pageGearData[4]=[{id:1,thumbnail:"https://imgur.com/n6iJRus.png",overlay:"",correct:false,applied:false,zIndex:1},{id:2,thumbnail:"https://i.imgur.com/oU1hjTk.png",overlay:"https://i.imgur.com/cPHvWTb.png",correct:true,applied:false,zIndex:2},{id:3,thumbnail:"https://i.imgur.com/Ui2tbVv.png",overlay:"https://i.imgur.com/S77YoN3.png",correct:true,applied:false,zIndex:4},{id:4,thumbnail:"https://i.imgur.com/Cbcyknu.png",overlay:"https://i.imgur.com/v5kUQPg.png",correct:true,applied:false,zIndex:3},{id:5,thumbnail:"https://i.imgur.com/nvoxlp7.png",overlay:"",correct:false,applied:false,zIndex:5},{id:6,thumbnail:"https://i.imgur.com/fdH4wzC.png",overlay:"",correct:false,applied:false,zIndex:6}];
    pageGearData[5]=[{id:1,thumbnail:"https://i.imgur.com/NnWSEdz.png",overlay:"https://i.imgur.com/ImnVVaf.png",correct:true,applied:false,zIndex:1},{id:2,thumbnail:"https://i.imgur.com/NdbXUPl.png",overlay:"https://i.imgur.com/IMelM9Q.png",correct:true,applied:false,zIndex:2},{id:3,thumbnail:"https://i.imgur.com/Z5ojhhi.png",overlay:"https://i.imgur.com/3KX2VD4.png",correct:true,applied:false,zIndex:3},{id:4,thumbnail:"https://i.imgur.com/Ui2tbVv.png",overlay:"",correct:false,applied:false,zIndex:4},{id:5,thumbnail:"https://i.imgur.com/Cbcyknu.png",overlay:"",correct:false,applied:false,zIndex:5},{id:6,thumbnail:"https://i.imgur.com/fdH4wzC.png",overlay:"",correct:false,applied:false,zIndex:6}];
    pageGearData[6]=[{id:1,thumbnail:"https://i.imgur.com/fdH4wzC.png",overlay:"https://i.imgur.com/fdH4wzC.png",correct:true,applied:false,zIndex:1},{id:2,thumbnail:"https://i.imgur.com/yvsCOBF.png",overlay:"https://i.imgur.com/yTJe79p.png",correct:true,applied:false,zIndex:2},{id:3,thumbnail:"https://i.imgur.com/F1PF0tE.png",overlay:"https://i.imgur.com/Gctejg5.png",correct:true,applied:false,zIndex:3},{id:4,thumbnail:"https://i.imgur.com/n6iJRus.png",overlay:"https://i.imgur.com/oAQe9gI.png",correct:true,applied:false,zIndex:4},{id:5,thumbnail:"https://i.imgur.com/d7Plzcn.png",overlay:"https://i.imgur.com/5VxjKY6.png",correct:true,applied:false,zIndex:5},{id:6,thumbnail:"https://i.imgur.com/NdbXUPl.png",overlay:"",correct:false,applied:false,zIndex:6}];
    pageGearData[7]=[{id:1,thumbnail:"https://i.imgur.com/yvsCOBF.png",overlay:"https://i.imgur.com/yTJe79p.png",correct:true,applied:false,zIndex:1},{id:2,thumbnail:"https://i.imgur.com/nvoxlp7.png",overlay:"https://i.imgur.com/VfJMtc3.png",correct:true,applied:false,zIndex:2},{id:3,thumbnail:"https://i.imgur.com/d7Plzcn.png",overlay:"https://i.imgur.com/5VxjKY6.png",correct:true,applied:false,zIndex:3},{id:4,thumbnail:"https://i.imgur.com/m1GZRHc.png",overlay:"https://i.imgur.com/Cphm4b5.png",correct:true,applied:false,zIndex:4},{id:5,thumbnail:"https://i.imgur.com/Cbcyknu.png",overlay:"",correct:false,applied:false,zIndex:5},{id:6,thumbnail:"https://i.imgur.com/Ui2tbVv.png",overlay:"",correct:false,applied:false,zIndex:6}];

    /* ---------- ìƒíƒœ ë³€ìˆ˜ ---------- */
    let currentScore = 0;
    let gameSequence = [3,4,5,6,7];
    let currentSequenceIndex = 0;
    let cycleCount = 1;
    let remainingChances = Infinity;
    const maxChancesPerCycle = {1:Infinity,2:10,default:5};

    /* ---------- ìœ í‹¸ ---------- */
    const $ = sel => document.querySelector(sel);

    function showPage(id){
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      $('#'+id).classList.add('active');
    }
    function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

    /* ---------- ì ìˆ˜/ê¸°íšŒ ---------- */
    function updateScore(){currentScore++;$('#current-score').textContent=currentScore;}
    function setChancesForCycle(){
      remainingChances = cycleCount===1?Infinity:cycleCount===2?maxChancesPerCycle[2]:maxChancesPerCycle.default;
      updateChancesUI();
    }
    function updateChancesUI(){
      const el=$('#remaining-chances'),box=$('#chances-display');
      box.classList.remove('cycle-1','cycle-2','cycle-3-plus');
      if(remainingChances===Infinity){el.textContent='âˆ';box.classList.add('cycle-1');}
      else if(cycleCount===2){el.textContent=remainingChances;box.classList.add('cycle-2');}
      else{el.textContent=remainingChances;box.classList.add('cycle-3-plus');}
    }
    function decreaseChances(){
      if(remainingChances===Infinity) return false;
      remainingChances--;updateChancesUI();
      if(remainingChances<0){
        setTimeout(()=>{alert(`ğŸ’€ëª¨ë“  ë³´í˜¸êµ¬ë¥¼ ì°©ìš©í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤ğŸ’€\ní˜„ì¬ ì ìˆ˜: ${currentScore}ì `);goToPage8();},500);
        return true;
      }
      return false;
    }

    /* ---------- ì´ˆê¸° í™”ë©´ ---------- */
    $('#startButton').onclick=()=>showPage('page2');

    /* ---------- ì…ë ¥ ì™„ë£Œ â†’ í˜ì´ì§€3 ---------- */
    $('#toPage3').onclick=()=>{
      if(!$('#siteName').value.trim()||!$('#workerName').value.trim()||!$('#workerAffiliation').value.trim()){
        alert('í˜„ì¥ëª…, ê·¼ë¡œì ì´ë¦„, ì†Œì†ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');return;
      }
      currentScore=0;currentSequenceIndex=0;cycleCount=1;
      $('#current-score').textContent='0';
      setChancesForCycle();showPage('page3');initPage(3);bindNextButtons();
      $('#score-display').style.display='block';
      $('#chances-display').style.display='block';
    };

    /* ---------- í˜ì´ì§€ë³„ ì´ˆê¸°í™” ---------- */
    function initPage(num){
      const grid=$(`#gear-grid-${num}`);grid.innerHTML='';
      pageGearData[num].forEach(i=>i.applied=false);
      shuffle([...pageGearData[num]]).forEach(item=>{
        const div=document.createElement('div');div.className='gear-item';
        const img=document.createElement('img');img.src=item.thumbnail;img.classList.add('rounded-border');
        img.onclick=()=>onGearClick(item,img,num);div.appendChild(img);grid.appendChild(div);
      });
      const btn=$(`#next-button-${num}`);btn.disabled=true;
      $(`#error-message-${num}`).textContent='';
    }

    /* ---------- ë³´í˜¸êµ¬ í´ë¦­ ---------- */
    function onGearClick(item,img,pageNum){
      if(cycleCount>1&&decreaseChances())return;
      if(item.correct){
        item.applied=!item.applied;
        img.style.opacity=item.applied?0.5:1;
        item.applied?addOverlay(item,pageNum):removeOverlay(item,pageNum);
      }else{
        const err=$(`#error-message-${pageNum}`);err.textContent='ì˜¬ë°”ë¥´ì§€ ì•Šì€ ë³´í˜¸êµ¬ì…ë‹ˆë‹¤.';setTimeout(()=>err.textContent='',2000);
      }
      checkComplete(pageNum);
    }
    function addOverlay(item,pageNum){
      if(!item.overlay)return;
      const o=document.createElement('img');
      o.src=item.overlay;o.className='overlay';o.dataset.id=item.id;
      o.style.cssText=`position:absolute;top:0;left:0;width:100%;height:100%;z-index:${item.zIndex}`;
      $(`#page${pageNum} .worker-container`).appendChild(o);
    }
    function removeOverlay(item,pageNum){
      const o=$(`#page${pageNum} .overlay[data-id="${item.id}"]`);o&&o.remove();
    }
    function checkComplete(num){
      const allApplied=pageGearData[num].filter(i=>i.correct).every(i=>i.applied);
      const btn=$(`#next-button-${num}`);btn.disabled=!allApplied;
      if(allApplied){
        updateScore();
      }
    }

    /* ---------- Next ë²„íŠ¼ ---------- */
    function bindNextButtons(){
      [3,4,5,6,7].forEach(n=>{
        $(`#next-button-${n}`).onclick=()=>{
          if(n===7){goToPage8();return;}
          const next=n+1;showPage(`page${next}`);initPage(next);
        };
      });
    }

    /* ---------- í˜ì´ì§€8 ---------- */
    function goToPage8(){
      $('#score-display').style.display='none';
      $('#chances-display').style.display='none';
      $('#cert-siteName').textContent="í˜„ì¥ëª…: "+$('#siteName').value;
      $('#cert-workerName').textContent="ê·¼ë¡œì ì´ë¦„: "+$('#workerName').value;
      $('#cert-workerAffiliation').textContent="ì†Œì†: "+$('#workerAffiliation').value;
      $('#final-score').textContent=currentScore;
      showPage('page8');
    }

    /* ---------- ìˆ˜ë£Œì¦ PNG ì €ì¥ ---------- */
    $('#saveCert').onclick=()=>{
      html2canvas($('#certificate-box')).then(c=>{
        const a=document.createElement('a');a.download='certificate.png';a.href=c.toDataURL();a.click();
      });
    };

    /* ---------- í™ˆ ---------- */
    $('#homeButton').onclick=()=>location.reload();
  </script>
</body>
</html>
