<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>작업별 보호구 착용 옷입히기 게임</title>
  <style>
    /* 공통 */
    body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif; background-color: #f5f5f7; }
    .page { display: none; }
    .page.active { display: block; }

    /* 애플 스타일 공통 컨테이너 */
    .apple-container { background-color: #ffffff; border-radius: 20px; padding: 40px; box-shadow: 0 4px 16px rgba(0,0,0,0.1); margin: 40px auto; max-width: 400px; }
    .apple-button { background-color: #007aff; color: #ffffff; border: none; border-radius: 10px; padding: 14px 28px; font-size: 17px; font-weight: 600; cursor: pointer; width: 100%; }
    .apple-button:active { background-color: #005ecb; }
    .apple-input { -webkit-appearance: none; appearance: none; background-color: #ffffff; border: 1px solid #d1d1d6; border-radius: 10px; padding: 12px 16px; width: 100%; font-size: 17px; margin-bottom: 20px; }
    h2 { font-size: 24px; font-weight: 600; margin-bottom: 24px; color: #1c1c1e; }

    /* 페이지1, 페이지2, 페이지8 스타일 */
    #page1, #page2, #page8 { min-height: 100vh; display: flex; justify-content: center; align-items: center; }

    /* 페이지1 */
    #page1 img { max-width: 100%; height: auto; margin-bottom: 24px; }

    /* 입력 안내 빨간 글씨 제거 (기존 .blink 스타일 그대로 숨김) */
    .blink { display: none; }

    /* 페이지8 수료증 박스 */
    #certificate-box { text-align: center; }
    #certificate-box h2 { color: #000000; margin-bottom: 16px; }

    /* 나머지 페이지(3-7)는 기존 스타일 유지 */
    /* ... (생략, 기존 CSS를 그대로 유지) */
  </style>
</head>
<body>
  <!-- 페이지1: 시작 화면 -->
  <div id="page1" class="page active">
    <div class="apple-container">
      <h2>작업별 보호구 착용 교육</h2>
      <img src="https://i.imgur.com/Tu6mJ5J.png" alt="메인 이미지">
      <button id="startButton" class="apple-button">교육 시작하기</button>
    </div>
  </div>

  <!-- 페이지2: 교육 정보 입력 -->
  <div id="page2" class="page">
    <div class="apple-container">
      <h2>교육 정보 입력</h2>
      <input type="text" id="siteName" class="apple-input" placeholder="현장명 입력">
      <input type="text" id="workerName" class="apple-input" placeholder="근로자 이름 입력">
      <input type="text" id="workerAffiliation" class="apple-input" placeholder="소속 입력">
      <button id="toPage3" class="apple-button">다음</button>
    </div>
  </div>

  <!-- 나머지 페이지3-7 동일 (기존 코드) -->
  <!-- ... (페이지3-7 코드 유지) -->

  <!-- 페이지8: 수료증 화면 -->
  <div id="page8" class="page">
    <div class="apple-container">
      <div id="certificate-box">
        <h2>수료증</h2>
        <p id="cert-siteName"></p>
        <p id="cert-workerName"></p>
        <p id="cert-workerAffiliation"></p>
        <p>최종 점수: <span id="final-score">0</span>점</p>
        <p>보호구 교육을 모두 수료하셨습니다.</p>
      </div>
      <button id="saveCert" class="apple-button" style="margin-top:20px;">저장하기</button>
      <button id="homeButton" class="apple-button" style="margin-top:10px;">홈으로</button>
      <h3 style="margin-top:40px; text-align:center; font-size:18px; font-weight:500; color:#1c1c1e;">🏆 이번 주 랭킹</h3>
      <div id="ranking-loading" style="text-align:center; color:#666; font-style:italic;">랭킹을 불러오는 중...</div>
      <table id="ranking-table" style="width:100%; display:none; border-collapse:collapse; margin-top:20px;">
        <thead><tr><th>순위</th><th>근로자 이름</th><th>현장명</th><th>소속</th><th>점수</th></tr></thead>
        <tbody id="ranking-body"></tbody>
      </table>
    </div>
  </div>

  <!-- 스크립트: 기존 그대로 (html2canvas 캡쳐 대상 변경 불필요) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    // 페이지 전환 및 게임 로직은 기존 코드 유지
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
    }
    document.getElementById('startButton').addEventListener('click', () => showPage('page2'));
    document.getElementById('toPage3').addEventListener('click', () => {
      if (!siteName.value.trim() || !workerName.value.trim() || !workerAffiliation.value.trim()) {
        alert('현장명, 근로자 이름, 소속을 모두 입력해주세요.');
        return;
      }
      showPage('page3');
      // ... (나머지 초기화 로직 이어서 실행)
    });

    document.getElementById('saveCert').addEventListener('click', () => {
      html2canvas(document.getElementById('certificate-box')).then(canvas => {
        const link = document.createElement('a');
        link.download = 'certificate.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    });
    document.getElementById('homeButton').addEventListener('click', () => location.reload());
  </script>
</body>
</html>
