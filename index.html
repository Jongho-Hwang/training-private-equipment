<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‘ì—…ë³„ ë³´í˜¸êµ¬ ì°©ìš© ì˜·ì…íˆê¸° ê²Œì„</title>
  <style>
    body { margin: 0; padding: 0; font-family: sans-serif; }
    .page { display: none; padding: 20px; }
    .active { display: block; }
    .center { text-align: center; }
    .rounded-border {
      border: 1px solid black;
      border-radius: 10px;
    }
    #page1 img { max-width: 100%; height: auto; }
    #page2 { text-align: left; }
    .blink { color: red; }
    .worker-container {
      position: relative;
      width: 100%;
      text-align: center;
    }
    .worker-image {
      width: 100%;
      height: auto;
      display: block;
      margin: 0 auto;
    }
    .gear-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .gear-item img {
      width: 80%;
      display: block;
      cursor: pointer;
      margin: 0 auto;
    }
    .score-display {
      position: fixed;
      bottom: 60px;
      right: 10px;
      background: #f0f0f0;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-weight: bold;
      z-index: 1000;
      min-width: 100px;
      text-align: center;
    }
    .chances-display {
      position: fixed;
      bottom: 10px;
      right: 10px;
      padding: 10px;
      border-radius: 5px;
      font-weight: bold;
      z-index: 1000;
      min-width: 100px;
      text-align: center;
    }
    .cycle-1 { background: #e8f5e8 !important; border: 2px solid #4caf50 !important; color: #2e7d32 !important; }
    .cycle-2 { background: #fff3e0 !important; border: 2px solid #ff9800 !important; color: #e65100 !important; }
    .cycle-3-plus { background: #ffebee !important; border: 2px solid #f44336 !important; color: #d32f2f !important; }
    #certificate-box {
      border: 2px solid #000;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    .button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      cursor: pointer;
    }
    .ranking-table {
      margin-top: 30px;
      border-collapse: collapse;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }
    .ranking-table th, .ranking-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    .ranking-table th { background-color: #f2f2f2; font-weight: bold; }
    .ranking-table tr:nth-child(even) { background-color: #f9f9f9; }
    .loading { text-align: center; color: #666; font-style: italic; }
    .button-group { margin-top: 20px; }
    .restart-button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
    }
    .restart-button:hover { background-color: #45a049; }
  </style>
</head>
<body>
  <div id="score-display" class="score-display" style="display:none;">
    ì ìˆ˜: <span id="current-score">0</span>
  </div>
  <div id="chances-display" class="chances-display" style="display:none;">
    í´ë¦­ ê¸°íšŒ: <span id="remaining-chances">âˆ</span>
  </div>

  <!-- í˜ì´ì§€1 -->
  <div id="page1" class="page active">
    <div class="center">
      <h1>ì‘ì—…ë³„ ë³´í˜¸êµ¬ ì°©ìš© êµìœ¡</h1>
      <img src="https://i.imgur.com/Tu6mJ5J.png" alt="ë©”ì¸ ì´ë¯¸ì§€">
      <br>
      <button class="button" id="startButton">êµìœ¡ ì‹œì‘í•˜ê¸°</button>
    </div>
  </div>

  <!-- í˜ì´ì§€2 -->
  <div id="page2" class="page">
    <h2>êµìœ¡ ì •ë³´ ì…ë ¥</h2>
    <label>í˜„ì¥ëª…:</label><br>
    <input type="text" id="siteName" placeholder="í˜„ì¥ëª… ì…ë ¥"><br><br>
    <label>ê·¼ë¡œì ì´ë¦„:</label><br>
    <input type="text" id="workerName" placeholder="ì´ë¦„ ì…ë ¥"><br><br>
    <label>ì†Œì†:</label><br>
    <input type="text" id="workerAffiliation" placeholder="ì†Œì† ì…ë ¥"><br><br>
    <div class="blink">ì‘ì—… ìƒí™©ì— ë”°ë¥¸ ë³´í˜¸êµ¬ ì°©ìš© ê¸°ì¤€ì„ ì˜·ì…íˆê¸° ê²Œì„ ë°©ì‹ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤. ê·¼ë¡œì ìºë¦­í„° í•˜ë‹¨ì˜ ë³´í˜¸êµ¬ë¥¼ í´ë¦­í•˜ì—¬ ì˜¬ë°”ë¥¸ ë³´í˜¸êµ¬ë¥¼ ì°©ìš©ì‹œì¼œì£¼ì„¸ìš”.</div>
    <br>
    <button class="button" id="toPage3">ë‹¤ìŒ</button>
  </div>

  <!-- í˜ì´ì§€3 -->
  <div id="page3" class="page">
    <h2>ê³ ì†Œì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/Ifwwzoz.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-3"></div>
    <div id="error-message-3" style="color:red;text-align:center;margin-top:10px;"></div>
    <div class="center button-group" id="button-container-3">
      <button class="button" id="next-button-3" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€4 -->
  <div id="page4" class="page">
    <h2>ìš©ì ‘ì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/WlQOZoc.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-4"></div>
    <div id="error-message-4" style="color:red;text-align:center;margin-top:10px;"></div>
    <div class="center button-group" id="button-container-4">
      <button class="button" id="next-button-4" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€5 -->
  <div id="page5" class="page">
    <h2>ì •ì „ì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/WlQOZoc.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-5"></div>
    <div id="error-message-5" style="color:red;text-align:center;margin-top:10px;"></div>
    <div class="center button-group" id="button-container-5">
      <button class="button" id="next-button-5" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€6 -->
  <div id="page6" class="page">
    <h2>ë„ì¥ì‘ì—…ì‹œ í•„ìˆ˜ì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/Ifwwzoz.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-6"></div>
    <div id="error-message-6" style="color:red;text-align:center;margin-top:10px;"></div>
    <div class="center button-group" id="button-container-6">
      <button class="button" id="next-button-6" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€7 -->
  <div id="page7" class="page">
    <h2>ì¼ë°˜ì‘ì—… ê³µí†µì°©ìš© ê°œì¸ë³´í˜¸êµ¬</h2>
    <div class="worker-container center">
      <img class="worker-image rounded-border" src="https://i.imgur.com/Ifwwzoz.png" alt="ê·¼ë¡œì ì´ë¯¸ì§€">
    </div>
    <div class="gear-grid" id="gear-grid-7"></div>
    <div id="error-message-7" style="color:red;text-align:center;margin-top:10px;"></div>
    <div class="center button-group" id="button-container-7">
      <button class="button" id="next-button-7" disabled>ë‹¤ìŒ</button>
    </div>
  </div>

  <!-- í˜ì´ì§€8 -->
  <div id="page8" class="page">
    <h2>ìˆ˜ë£Œì¦</h2>
    <div id="certificate-box">
      <p id="cert-siteName"></p>
      <p id="cert-workerName"></p>
      <p id="cert-workerAffiliation"></p>
      <p>ë³´í˜¸êµ¬ êµìœ¡ì„ ëª¨ë‘ ìˆ˜ë£Œí•˜ì…¨ìŠµë‹ˆë‹¤.</p>
    </div>
    <div style="text-align:center;">
      <button class="button" id="saveCert">ì €ì¥í•˜ê¸°</button>
      <button class="button" id="homeButton">í™ˆìœ¼ë¡œ</button>
      <h3>ğŸ† ì´ë²ˆ ì£¼ ë­í‚¹</h3>
      <div id="ranking-loading" class="loading">ë­í‚¹ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
      <table id="ranking-table" class="ranking-table" style="display:none;">
        <thead>
          <tr><th>ìˆœìœ„</th><th>ê·¼ë¡œì ì´ë¦„</th><th>í˜„ì¥ëª…</th><th>ì†Œì†</th><th>ì ìˆ˜</th></tr>
        </thead>
        <tbody id="ranking-body"></tbody>
      </table>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    // Firebase ì´ˆê¸°í™”
    const firebaseConfig = { /* ì—¬ê¸°ì— ì‹¤ì œ ì„¤ì • ì‚½ì… */ };
    try { firebase.initializeApp(firebaseConfig); } catch(e){}
    let db = firebase.firestore();

    // 3~7 í˜ì´ì§€ë³„ ë³´í˜¸êµ¬ ë°ì´í„°
    const pageGearData = {
      3: [
        { id:1, thumbnail:'https://i.imgur.com/yvsCOBF.png', overlay:'https://i.imgur.com/yTJe79p.png', correct:true, zIndex:1 },
        { id:2, thumbnail:'https://i.imgur.com/8gsL65v.png', overlay:'https://i.imgur.com/zBCjthf.png', correct:true, zIndex:2 },
        { id:3, thumbnail:'https://i.imgur.com/nvoxlp7.png', overlay:'https://i.imgur.com/VfJMtc3.png', correct:true, zIndex:3 },
        { id:4, thumbnail:'https://i.imgur.com/m1GZRHc.png', overlay:'https://i.imgur.com/Cphm4b5.png', correct:true, zIndex:4 },
        { id:5, thumbnail:'https://i.imgur.com/d7Plzcn.png', overlay:'https://i.imgur.com/5VxjKY6.png', correct:true, zIndex:5 },
        { id:6, thumbnail:'https://i.imgur.com/Ui2tbVv.png', overlay:'', correct:false, zIndex:6 }
      ],
      4: [
        { id:1, thumbnail:'https://imgur.com/n6iJRus.png', overlay:'', correct:false, zIndex:1 },
        { id:2, thumbnail:'https://i.imgur.com/oU1hjTk.png', overlay:'https://i.imgur.com/cPHvWTb.png', correct:true, zIndex:2 },
        { id:3, thumbnail:'https://i.imgur.com/Ui2tbVv.png', overlay:'https://i.imgur.com/S77YoN3.png', correct:true, zIndex:4 },
        { id:4, thumbnail:'https://i.imgur.com/Cbcyknu.png', overlay:'https://i.imgur.com/v5kUQPg.png', correct:true, zIndex:3 },
        { id:5, thumbnail:'https://i.imgur.com/nvoxlp7.png', overlay:'', correct:false, zIndex:5 },
        { id:6, thumbnail:'https://i.imgur.com/fdH4wzC.png', overlay:'', correct:false, zIndex:6 }
      ],
      5: [
        { id:1, thumbnail:'https://i.imgur.com/NnWSEdz.png', overlay:'https://i.imgur.com/ImnVVaf.png', correct:true, zIndex:1 },
        { id:2, thumbnail:'https://i.imgur.com/NdbXUPl.png', overlay:'https://i.imgur.com/IMelM9Q.png', correct:true, zIndex:2 },
        { id:3, thumbnail:'https://i.imgur.com/Z5ojhhi.png', overlay:'https://i.imgur.com/3KX2VD4.png', correct:true, zIndex:3 },
        { id:4, thumbnail:'https://i.imgur.com/Ui2tbVv.png', overlay:'', correct:false, zIndex:4 },
        { id:5, thumbnail:'https://i.imgur.com/Cbcyknu.png', overlay:'', correct:false, zIndex:5 },
        { id:6, thumbnail:'https://i.imgur.com/fdH4wzC.png', overlay:'', correct:false, zIndex:6 }
      ],
      6: [
        { id:1, thumbnail:'https://i.imgur.com/fdH4wzC.png', overlay:'https://i.imgur.com/fdH4wzC.png', correct:true, zIndex:1 },
        { id:2, thumbnail:'https://i.imgur.com/yvsCOBF.png', overlay:'https://i.imgur.com/yTJe79p.png', correct:true, zIndex:2 },
        { id:3, thumbnail:'https://i.imgur.com/F1PF0tE.png', overlay:'https://i.imgur.com/Gctejg5.png', correct:true, zIndex:3 },
        { id:4, thumbnail:'https://i.imgur.com/n6iJRus.png', overlay:'https://i.imgur.com/oAQe9gI.png', correct:true, zIndex:4 },
        { id:5, thumbnail:'https://i.imgur.com/d7Plzcn.png', overlay:'https://i.imgur.com/5VxjKY6.png', correct:true, zIndex:5 },
        { id:6, thumbnail:'https://i.imgur.com/NdbXUPl.png', overlay:'', correct:false, zIndex:6 }
      ],
      7: [
        { id:1, thumbnail:'https://i.imgur.com/yvsCOBF.png', overlay:'https://i.imgur.com/yTJe79p.png', correct:true, zIndex:1 },
        { id:2, thumbnail:'https://i.imgur.com/nvoxlp7.png', overlay:'https://i.imgur.com/VfJMtc3.png', correct:true, zIndex:2 },
        { id:3, thumbnail:'https://i.imgur.com/d7Plzcn.png', overlay:'https://i.imgur.com/5VxjKY6.png', correct:true, zIndex:3 },
        { id:4, thumbnail:'https://i.imgur.com/m1GZRHc.png', overlay:'https://i.imgur.com/Cphm4b5.png', correct:true, zIndex:4 },
        { id:5, thumbnail:'https://i.imgur.com/Cbcyknu.png', overlay:'', correct:false, zIndex:5 },
        { id:6, thumbnail:'https://i.imgur.com/Ui2tbVv.png', overlay:'', correct:false, zIndex:6 }
      ]
    };

    // ì´í•˜ ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€
    // ...
  </script>
</body>
</html>
